From 204aa31c554dda6a30ea0a811063e337cf552893 Mon Sep 17 00:00:00 2001
From: Thomas Guillem <thomas@gllm.fr>
Date: Mon, 18 Mar 2019 14:12:56 +0100
Subject: [PATCH 59/76] smb2: add missing error check

(cherry picked from commit 014e84a30c54a1831ed4deeac6506d98cde503b8)
Signed-off-by: Thomas Guillem <thomas@gllm.fr>
---
 modules/access/smb2.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/modules/access/smb2.c b/modules/access/smb2.c
index e32e3dd0c9..4defe4c98e 100644
--- a/modules/access/smb2.c
+++ b/modules/access/smb2.c
@@ -736,6 +736,8 @@ vlc_smb2_resolve(stream_t *access, const char *host, unsigned port)
     /* Test if the host is a netbios name */
     char *out_host = NULL;
     netbios_ns *ns = netbios_ns_new();
+    if (!ns)
+        return NULL;
     uint32_t ip4_addr;
     if (netbios_ns_resolve(ns, host, NETBIOS_FILESERVER, &ip4_addr) == 0)
     {
-- 
2.32.0 (Apple Git-132)

